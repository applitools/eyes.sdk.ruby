language: ruby
rvm:
  - 1.9.3
  - 2.0.0
  - 2.1.6
  - 2.3.1
  - 2.4.1
  - rbx-2
gemfile:
  - GemfileTravis
env:
  - END_TO_END_TESTS=false
  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=classic TEST_IN_BROWSER=chrome TEST_PLATFORM=linux
  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=classic TEST_IN_BROWSER=firefox TEST_PLATFORM=linux
  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=fluent TEST_IN_BROWSER=chrome TEST_PLATFORM=linux
  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=fluent TEST_IN_BROWSER=firefox TEST_PLATFORM=linux
#  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=classic TEST_IN_BROWSER=chrome TEST_PLATFORM=windows
#  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=classic TEST_IN_BROWSER=firefox TEST_PLATFORM=windows
#  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=fluent TEST_IN_BROWSER=chrome TEST_PLATFORM=windows
#  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=fluent TEST_IN_BROWSER=firefox TEST_PLATFORM=windows
#  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=classic TEST_IN_BROWSER=chrome TEST_PLATFORM=macos
#  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=classic TEST_IN_BROWSER=firefox TEST_PLATFORM=macos
#  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=fluent TEST_IN_BROWSER=chrome TEST_PLATFORM=macos
#  - END_TO_END_TESTS=true SELENIUM_SERVER_URL=http://ondemand.saucelabs.com/wd/hub TEST_API=fluent TEST_IN_BROWSER=firefox TEST_PLATFORM=macos
matrix:
  allow_failures:
    - rvm: rbx-2
sudo: false

branches:
  only:
    - master
    - development

before_install:
  - "gem install builder"
  - "BUILD_ONLY=true rake clean build"
  - "cd pkg; mkdir gems; mv ./*.gem ./gems; gem generate_index; cd .."
before_script:
  - "export APPLITOOLS_BATCH_ID=$(java UUIDFromString $TRAVIS_COMMIT$TRAVIS_RUBY_VERSION)"
  - "echo $APPLITOOLS_BATCH_ID"
script:
  - bundle exec rake
